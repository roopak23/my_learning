CREATE TABLE IF NOT EXISTS `STG_SA_Past_Campaign_Performances` (
	`sys_datasource` STRING,
    `sys_load_id` BIGINT,
    `sys_created_on` TIMESTAMP,
	`date` BIGINT,
	`creation_date` BIGINT,
	`system_id` STRING,
	`tech_order_id` STRING,
	`tech_line_id` STRING,
	`remote_id` STRING,
	`report_id` STRING,
	`device` STRING,
	`time_of_day` STRING,
	`day_of_week` STRING,
	`time_range` STRING,
	`gender` STRING,
	`age` STRING,
	`family_status` STRING,
	`first_party_data` STRING,
	`second_party_data` STRING,
	`third_party_data` STRING,
	`income` STRING,
	`keyword_match_type` STRING,
	`keyword` STRING,
	`display_format` STRING,
	`ad_copy` STRING,
	`social_placement` STRING,
	`creative_name` STRING,
	`placement` STRING,
	`network_type` STRING,
	`country` STRING,
	`state` STRING,
	`region` STRING,
	`city` STRING,
	`ad_slot` STRING,
	`clicks` INT,
	`impressions` INT,
	`spend` DOUBLE,
	`spend_gads` DOUBLE,
	`reach` INT,
	`ctr` DOUBLE,
	`conversions` DOUBLE,
	`cprm` DOUBLE,
	`cpcv` DOUBLE,
	`post_engagement` DOUBLE,
	`player_100` DOUBLE,
	`search_impression_share` DOUBLE,
	`display_impression_share` DOUBLE,
	`cpm` DOUBLE,
	`cpa` DOUBLE,
	`cpc` DOUBLE,
	`cpv` DOUBLE,
	`player_25` DOUBLE,
	`player_50` DOUBLE,
	`player_75` DOUBLE,
	`frequency_capping` STRING,
	`frequency_capping_quantity` INT,
	`view` INT,
	`view_rate` DOUBLE,
	`post_reaction` INT,
	`comment` INT,
	`onsite_conversion_post_save` INT,
	`link_click` INT,
	`like` INT,
	`ad_quality_ranking` STRING,
	`player_mute` DOUBLE,
	`player_unmute` DOUBLE,
	`player_engaged_views` DOUBLE,
	`player_starts` DOUBLE,
	`player_skip` DOUBLE,
	`sampled_viewed_impressions` DOUBLE,
	`sampled_tracked_impressions` DOUBLE,
	`sampled_in_view_rate` DOUBLE,
	`companion_impressions` DOUBLE,
	`companion_clicks` DOUBLE,
	`unique_id` DOUBLE,
	`frequency_per_unique_id` DOUBLE,
	`data_cost` DOUBLE,
	`deal_id` STRING,
	`site_list_name` STRING,
	`bids` INT,
	`win_rate` DOUBLE,
	`email_total_sent` DOUBLE,
	`unique_open_rate` DOUBLE,
	`unique_click_rate` DOUBLE,
	`sms_total_sent` DOUBLE,
	`email_opened` DOUBLE,
	`email_clicked` DOUBLE,
    `ad_unit_id` STRING,
	`ad_unit_name` STRING
)
PARTITIONED BY (partition_date INT)
--CLUSTERED BY (system_id) INTO 5 BUCKETS --> TBD
STORED AS ORC
LOCATION '{{ params.TABLEHOST }}://{{ params.ROOTPATH }}/{{ params.HIVE_DATA_PATH }}/STG_SA_Past_Campaign_Performances'
TBLPROPERTIES("transactional"="true");

MSCK REPAIR TABLE `STG_SA_Past_Campaign_Performances`;