CREATE TABLE IF NOT EXISTS `STG_AdServer_NetworkImpressions` (
	`sys_datasource` STRING,
    `sys_load_id` BIGINT,
    `sys_created_on` TIMESTAMP,
	`seller_reserve_price` INT,
	`active_view_eligible_impression` STRING,
	`ad_unit_id` STRING,
	`advertiser` STRING,
	`advertiser_id` STRING,
	`adx_account_id` STRING,
	`anonymous` STRING,
	`audience_segment_ids` INT,
	`band_width` STRING,
	`bandwidth_group_id` INT,
	`bandwidth_id` INT,
	`browser` STRING,
	`browser_id` INT,
	`buyer` STRING,
	`city` STRING,
	`city_id` INT,
	`cms_metadata` STRING,
	`country` STRING,
	`country_id` INT,
	`creative_id` STRING,
	`creative_size` STRING,
	`creative_size_delivered` STRING,
	`creative_version` STRING,
	`custom_targeting` STRING,
	`deal_id` STRING,
	`deal_type` STRING,
	`device_category` STRING,
	`domain` STRING,
	`estimated_backfill_revenue` DOUBLE,
	`event_key_part` STRING,
	`event_time_usec2` BIGINT,
	`gfp_content_id` INT,
	`ip` STRING,
	`impression_id` STRING,
	`is_companion` STRING,
	`is_STRINGerstitial` STRING,
	`key_part` STRING,
	`line_item_id` STRING,
	`metro` STRING,
	`metro_id` INT,
	`mobile_app_id` STRING,
	`mobile_capability` STRING,
	`mobile_carrier` STRING,
	`mobile_device` STRING,
	`native_format` STRING,
	`native_style` STRING,
	`os` STRING,
	`os_id` STRING,
	`os_version` STRING,
	`optimization_type` STRING,
	`order_id` STRING,
	`pod_position` INT,
	`postal_code` INT,
	`postal_code_id` INT,
	`product` STRING,
	`publisher_provided_id` STRING,
	`referer_url` STRING,
	`region` STRING,
	`region_id` INT,
	`request_language` STRING,
	`requested_ad_unit_sizes` STRING,
	`serving_restriction` STRING,
	`targeted_custom_criteria` STRING,
	`time` STRING,
	`time_usec` INT,
	`time_usec2` BIGINT,
	`user_id` STRING,
	`video_fallback_position` INT,
	`video_position` INT,
	`yield_group_company_id` STRING,
	`yield_group_names` STRING,
	`meta_application_name_version` STRING,
	`meta_application_run_id` STRING,
	`meta_event_table_name` STRING,
	`meta_timestamp` STRING,
	`meta_schema_version` STRING,
	`meta_partition_STRING` STRING,
	`meta_partition_hh` INT,
	`meta_partition_valid` STRING,
	`meta_uuid` STRING,
	`meta_payload` STRING,
	`meta_physical_partition_date` STRING,
	`meta_physical_partition_hh` INT
)
PARTITIONED BY (partition_date INT)
STORED AS ORC
LOCATION '{{ params.TABLEHOST }}://{{ params.ROOTPATH }}/{{ params.HIVE_DATA_PATH }}/STG_AdServer_NetworkImpressions'
TBLPROPERTIES("transactional"="true");

msck repair table `STG_AdServer_NetworkImpressions`;