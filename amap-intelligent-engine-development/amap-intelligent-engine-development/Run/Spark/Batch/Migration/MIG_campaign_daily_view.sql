SELECT
	md5(concat(nvl(`report_id`,'null'),'_',cast(`date_update` as string),'_',`market_order_line_details_id`,'_',nvl(`device`,'null'),'_',nvl(`time_of_day`,'null'),'_',nvl(`day_of_week`,'null'),'_',nvl(`time_range`,'null'),'_',nvl(`gender`,'null'),'_',nvl(`age`,'null'),'_',nvl(`family_status`,'null'),'_',nvl(`first_party_data`,'null'),'_',nvl(`second_party_data`,'null'),'_',nvl(`third_party_data`,'null'),'_',nvl(`income`,'null'),'_',nvl(`keyword_match_type`,'null'),'_',nvl(`display_format`,'null'),'_',nvl(`ad_copy`,'null'),'_',nvl(`social_placement`,'null'),'_',nvl(`creative_name`,'null'),'_',nvl(`placement`,'null'),'_',nvl(`network_type`,'null'),'_',nvl(`country`,'null'),'_',nvl(`state`,'null'),'_',nvl(`region`,'null'),'_',nvl(`city`,'null'),'_',nvl(`ad_slot`,'null'),'_',nvl(`keyword`,'null'),'_',nvl(`deal_id`,'null'),'_',nvl(`site_list_name`,'null'))) as id,
	`report_id`,
	`date_update`,
	`creation_date`,
	`brand_id`,
	`brand_name`,
	`advertiser_id`,
	`advertiser_name`,
	`industry`,
	`campaign_name`,
	`campaign_remote_id`,
	`tech_line_remote_id`,
	`market_order_line_details_id`,
	`market_order_line_details_name`,
	`commercial_audience`,
	`start_date`,
	`end_date`,
	`campaign_type`,
	`mold_status`,
	`campaign_status`,
	`objective`,
	`adserver_id`,
	`adserver_name`,
	`bid_strategy`,
	round(round(`actual_pacing`,4),3) as `actual_pacing`,
	`budget`,
	`target_kpi`,
	`target_kpi_value`,
	`impressions_act`,
	`clicks_act`,
	round(round(`ctr_act`,4),3) as `ctr_act`,
	`reach_act`,
	`running_days_elapsed`,
	`remaining_days`,
	round(round(`conversions`,4),3) as `conversions`,
	round(round(`cprm`,4),3) as `cprm`,
	round(round(`cpcv`,4),3) as `cpcv`,
	round(round(`post_engagement`,4),3) as `post_engagement`,
	round(round(`player_100`,4),3) as `player_100`,
	round(round(`search_impression_share`,4),3) as `search_impression_share`,
	round(round(`display_impression_share`,4),3) as `display_impression_share`,
	round(round(`budget_act`,4),3) as `budget_act`,
	round(round(`cpm`,4),3) as `cpm`,
	round(round(`cpa`,4),3) as `cpa`,
	round(round(`cpc`,4),3) as `cpc`,
	round(round(`cpv`,4),3) as `cpv`,
	round(round(`player_25`,4),3) as `player_25`,
	round(round(`player_50`,4),3) as `player_50`,
	round(round(`player_75`,4),3) as `player_75`,
	`view`,
	round(round(`view_rate`,4),3) as `view_rate`,
	`ad_quality_ranking`,
	`pacing_type`,
	`frequency_capping_type`,
	`frequency_capping_quantity`,
	`post_reaction`,
	`comment`,
	`onsite_conversion_post_save`,
	`link_click`,
	`like`,
	`device`,
	`time_of_day`,
	`day_of_week`,
	`time_range`,
	`gender`,
	`age`,
	`family_status`,
	`first_party_data`,
	`second_party_data`,
	`third_party_data`,
	`income`,
	`keyword_match_type`,
	`display_format`,
	`ad_copy`,
	`social_placement`,
	`creative_name`,
	`placement`,
	`network_type`,
	`country`,
	`state`,
	`region`,
	`city`,
	`ad_slot`,
	`keyword`,
	`player_mute`,
	`player_unmute`,
	`player_engaged_views`,
	`player_starts`,
	`player_skip`,
	`sampled_viewed_impressions`,
	`sampled_tracked_impressions`,
	`sampled_in_view_rate`,
	`companion_impressions`,
	`companion_clicks`,
	`unique_id`,
	`frequency_per_unique_id`,
	`data_cost`,
	`deal_id`,
	`site_list_name`,
	`bids`,
	`win_rate`,
	`email_total_sent`,
	`unique_open_rate`,
	`unique_click_rate`,
	`sms_total_sent`	
FROM TRF_Campaign_Daily_View  
where partition_date = {{ params.ENDDATE }}